<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <!-- Tối ưu hóa Viewport cho cảm giác "App" -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#030712"> <!-- Màu nền đậm hơn -->
    <title>Text2 - Translate | LLM </title>
    
    <!-- Meta tags SEO và OG (Giữ nguyên) -->
    <meta name="description" content="Text2 - Translate is a smart translation tool powered by AI. Translate between Vietnamese and English with context-aware accuracy.">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" type="image/png" sizes="32x32" href="https://translate.text2.click/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://translate.text2.click/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://translate.text2.click/apple-touch-icon.png">

    <!-- Google Ads & Analytics (Giữ nguyên) -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1722731267767270"
     crossorigin="anonymous"></script>
    <script async src="https://www.googlesyndication.com/gtag/js?id=G-6J85STMJ14"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-6J85STMJ14');
    </script>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Inter font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- CSS Tối ưu hóa "App-like" -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            color-scheme: dark;
            /* Ngăn overscroll "nảy" trên mobile */
            overflow: hidden; 
        }
        
        /* Keyframe cho animation (được giữ lại từ file gốc) */
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Nút copy-button khi được click (JS sẽ thêm class 'copied') */
        .copy-button.copied {
            @apply !bg-gradient-to-r !from-green-500 !to-emerald-500 shadow-lg;
        }

        /* Nút chọn ngôn ngữ (JS sẽ thêm class 'active') */
        .direction-option.active {
            @apply bg-gray-700/70 text-blue-400 shadow-inner;
        }

        /* Bộ đếm ký tự (JS sẽ thêm class 'limit-reached') */
        .char-counter.limit-reached {
            @apply !text-red-400 !bg-red-900/30;
        }

        /* Ngăn iOS tự động zoom khi focus vào textarea */
        @media (max-width: 768px) {
            textarea:focus, input:focus {
                font-size: 16px !important;
            }
        }
        
        /* Tùy chỉnh thanh cuộn cho cảm giác "app" hơn */
        .main-content-scrollable::-webkit-scrollbar {
            width: 6px;
        }
        .main-content-scrollable::-webkit-scrollbar-track {
            background: transparent;
        }
        .main-content-scrollable::-webkit-scrollbar-thumb {
            background-color: rgba(107, 114, 128, 0.5); /* gray-500/50 */
            border-radius: 20px;
        }
    </style>
</head>

<!-- THAY ĐỔI: Bố cục flex-col full-height cho body -->
<body class="bg-gray-950 text-gray-200 flex flex-col h-[calc(var(--vh,1vh)*100)]">

    <!-- Header (App Bar) - Cố định -->
    <div class="header flex justify-between items-center p-4 md:p-5 border-b border-gray-700/50 bg-gray-900/80 backdrop-blur-lg flex-shrink-0 z-10 shadow-md">
        <div class="logo-section flex items-center gap-3">
            <img src="https://translate.text2.click/favicon.ico" alt="Text2.click Logo" class="logo w-9 h-9 md:w-10 md:h-10 rounded-lg shadow-lg">
            <div>
                <div class="brand-name text-base md:text-lg font-extrabold uppercase tracking-wider text-white">Text2 Translate</div>
            </div>
        </div>
        <div class="header-right text-xs text-gray-500 opacity-90">&nbsp;</div>
    </div>

    <!-- Nội dung chính (Scrollable) -->
    <!-- THAY ĐỔI: Container này sẽ tự co giãn và cuộn, thay vì toàn bộ trang -->
    <div class="main-content-scrollable flex-1 overflow-y-auto p-4 md:p-8" style="animation: slideUp 0.6s ease-out;">
        
        <!-- Lưới Dịch -->
        <!-- THAY ĐỔI: Bỏ cột "auto" ở giữa, chuyển thành 2 cột đều nhau trên desktop -->
        <div class="translation-grid grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 items-start">
            
            <!-- Cột Input (Tự co giãn) (Giữ nguyên) -->
            <div class="text-area-container relative flex flex-col gap-3 h-full">
                <label for="inputText" class="text-area-label flex justify-between items-center text-sm font-semibold text-gray-300">
                    <span id="sourceLanguageLabel" class="flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                        <span>🇻🇳 Tiếng Việt</span>
                    </span>
                </label>
                <textarea id="inputText" class="text-area w-full p-4 bg-gray-900/60 border-2 border-gray-700/80 rounded-xl text-gray-100 text-base leading-relaxed resize-none focus:outline-none focus:ring-4 focus:ring-blue-500/30 focus:border-blue-500 transition-all duration-300 flex-grow min-h-[200px] md:min-h-[300px]" placeholder="Nhập văn bản để dịch..."></textarea>
                <div id="charCount" class="char-counter absolute bottom-3 left-4 text-xs text-gray-500 bg-gray-800/80 px-2 py-1 rounded-md border border-gray-700/50 transition-colors">0/500 characters</div>
            </div>

            <!-- Nút Dịch (ĐÃ DI CHUYỂN XUỐNG FOOTER) -->

            <!-- Cột Output (Tự co giãn) (Giữ nguyên) -->
            <div class="text-area-container relative flex flex-col gap-3 h-full">
                <label for="outputText" class="text-area-label flex justify-between items-center text-sm font-semibold text-gray-300">
                    <span id="targetLanguageLabel" class="flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        <span>🇺🇸 English</span>
                    </span>
                    <button id="copyButton" class="copy-button flex items-center justify-center w-8 h-8 rounded-lg bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-md hover:scale-105 active:scale-95 transition-all" title="Copy kết quả">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                    </button>
                </label>
                <textarea id="outputText" class="text-area w-full p-4 bg-gray-800/70 border-2 border-gray-700/80 rounded-xl text-gray-300 text-base leading-relaxed resize-none focus:outline-none flex-grow min-h-[200px] md:min-h-[300px]" readonly placeholder="Kết quả dịch sẽ xuất hiện ở đây..."></textarea>
            </div>
        </div>

        <!-- Khu vực Điều khiển (Giữ nguyên) -->
        <div class="controls-section flex flex-col gap-4 md:gap-5 mt-6 md:mt-8">
            
            <div class="flex flex-col sm:flex-row items-center gap-3">
                <!-- Chọn Ngôn ngữ (Giờ nằm trong khu vực cuộn) -->
                <div class="direction-selector flex-grow w-full flex flex-col md:flex-row gap-2 md:gap-1 p-1 bg-gray-800/50 border border-gray-700/50 rounded-xl">
                    <button id="viEnOption" class="direction-option active flex-1 px-4 py-3 rounded-lg text-sm md:text-base font-medium text-gray-400 hover:bg-gray-700/50 transition-all cursor-pointer text-center">🇻🇳 Tiếng Việt → 🇺🇸 English</button>
                    <button id="enViOption" class="direction-option flex-1 px-4 py-3 rounded-lg text-sm md:text-base font-medium text-gray-400 hover:bg-gray-700/50 transition-all cursor-pointer text-center">🇺🇸 English → 🇻🇳 Tiếng Việt</button>
                </div>

                <!-- Nút Swap (Giữ nguyên) -->
                <button id="swapButton" class="swap-button flex-shrink-0 flex items-center justify-center w-full sm:w-12 h-12 bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg text-white shadow-lg hover:scale-110 active:scale-95 transition-all" title="Đảo ngược ngôn ngữ">
                    <svg class="swap-icon w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path></svg>
                </button>
            </div>

            <!-- Thông báo Lỗi (Giữ nguyên) -->
            <div id="errorMessage" class="error-message p-3 bg-red-900/40 border border-red-700/50 text-red-300 text-sm rounded-lg text-center hidden"></div>
        </div>

        <!-- Tính năng (Giờ nằm cuối khu vực cuộn) -->
        <div class="features mt-8 pt-8 border-t border-gray-700/50">
            <div class="feature flex flex-col sm:flex-row items-center gap-4 p-4 bg-gray-800/40 rounded-lg border border-gray-700/50">
                <svg class="feature-icon w-8 h-8 text-blue-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                <div class="text-center sm:text-left">
                    <div class="feature-title font-semibold text-gray-100">Context-Aware Translation</div>
                    <div class="feature-desc text-sm text-gray-400">We are building context-aware translation software powered by LLM language models.</div>
                </div>
            </div>
        </div>
        
        <!-- Thêm một khoảng đệm an toàn ở cuối để không bị che bởi thanh action -->
        <div class="h-8 md:h-12 flex-shrink-0"></div>

    </div>

    <!-- THAY ĐỔI: Thanh Action Bar (Footer) - Cố định -->
    <div class="footer-action-bar p-3 md:p-4 bg-gray-900/80 backdrop-blur-lg border-t border-gray-700/50 flex-shrink-0 z-10 shadow-inner">
        <!-- Nút Dịch (Vị trí mới, style mới) -->
        <button id="translateButton" class="translate-button flex items-center justify-center gap-3 w-full h-12 md:h-14 rounded-xl bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg hover:shadow-xl hover:-translate-y-0.5 active:scale-[0.99] transition-all disabled:opacity-60 disabled:cursor-not-allowed disabled:transform-none">
            <!-- THAY ĐỔI: Icon và Text nằm ngang -->
            <span id="translateIcon" class="flex items-center justify-center">
                <!-- THAY ĐỔI: Kích thước icon nhất quán -->
                <svg class="w-5 h-5 md:w-6 md:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
            </span>
            <!-- THAY ĐỔI: Cỡ chữ to hơn -->
            <span id="buttonText" class="text-base md:text-lg font-semibold">Translate</span>
            <!-- THAY ĐỔI: Kích thước spinner nhất quán -->
            <div id="loadingSpinner" class="loading-spinner w-6 h-6 border-2 border-white/20 border-t-white rounded-full animate-spin hidden"></div>
        </button>
    </div>


    <!-- JAVASCRIPT (GIỮ NGUYÊN HOÀN TOÀN) -->
    <!-- Logic JS vẫn tương thích 100% với các ID đã được giữ lại -->
    <script>
        // DOM Elements
        const inputText = document.getElementById('inputText');
        const outputText = document.getElementById('outputText');
        const translateButton = document.getElementById('translateButton');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const errorMessage = document.getElementById('errorMessage');
        const charCount = document.getElementById('charCount');
        const buttonText = document.getElementById('buttonText');
        const translateIcon = document.getElementById('translateIcon'); 
        const swapButton = document.getElementById('swapButton');
        const viEnOption = document.getElementById('viEnOption');
        const enViOption = document.getElementById('enViOption');
        const copyButton = document.getElementById('copyButton');
        const sourceLanguageLabel = document.getElementById('sourceLanguageLabel');
        const targetLanguageLabel = document.getElementById('targetLanguageLabel');


        // API Key (Từ V1)
        const workerUrl = "https://text2llmgroq.text2team.workers.dev/"; // đổi thành URL Worker của bạn
        const MAX_CHARS = 500;

        // Copy functionality (Từ V1)
        copyButton.addEventListener('click', async () => {
            const textToCopy = outputText.value.trim();
            
            if (!textToCopy) {
                showError('No text to copy. Please translate something first.');
                return;
            }

            try {
                await navigator.clipboard.writeText(textToCopy);
                
                // Visual feedback
                copyButton.classList.add('copied');
                copyButton.innerHTML = `
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                `;
                
                // Reset after 2 seconds
                setTimeout(() => {
                    copyButton.classList.remove('copied');
                    copyButton.innerHTML = `
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                        </svg>
                    `;
                }, 2000);
                
            } catch (err) {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = textToCopy;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                // Visual feedback (giống như trên)
                copyButton.classList.add('copied');
                copyButton.innerHTML = `
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                `;
                setTimeout(() => {
                    copyButton.classList.remove('copied');
                    copyButton.innerHTML = `
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                        </svg>
                    `;
                }, 2000);
            }
        });

        // Translation direction state (Từ V1)
        let currentDirection = 'vi-en';

        // Hàm cập nhật label (Từ V1)
        function updateLanguageLabels(direction) {
            if (direction === 'vi-en') {
                sourceLanguageLabel.innerHTML = `
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                    <span>🇻🇳 Tiếng Việt</span>
                `;
                targetLanguageLabel.innerHTML = `
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    <span>🇺🇸 English</span>
                `;
            } else { // 'en-vi'
                sourceLanguageLabel.innerHTML = `
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                    <span>🇺🇸 English</span>
                `;
                targetLanguageLabel.innerHTML = `
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    <span>🇻🇳 Tiếng Việt</span>
                `;
            }
        }

        // Character counter (Từ V1)
        inputText.addEventListener('input', () => {
            const currentLength = inputText.value.length;
            if (currentLength > MAX_CHARS) {
                inputText.value = inputText.value.substring(0, MAX_CHARS);
                charCount.textContent = `${MAX_CHARS}/${MAX_CHARS} characters (limit reached)`;
                charCount.classList.add('limit-reached');
            } else {
                charCount.textContent = `${currentLength}/${MAX_CHARS} characters`;
                charCount.classList.remove('limit-reached');
            }
        });

        // Direction selector (Từ V1)
        viEnOption.addEventListener('click', () => {
            currentDirection = 'vi-en';
            viEnOption.classList.add('active');
            enViOption.classList.remove('active');
            updateLanguageLabels(currentDirection); 
        });

        enViOption.addEventListener('click', () => {
            currentDirection = 'en-vi';
            enViOption.classList.add('active');
            viEnOption.classList.remove('active');
            updateLanguageLabels(currentDirection); 
        });

        // Swap button (Từ V1)
        swapButton.addEventListener('click', () => {
            if (currentDirection === 'vi-en') {
                currentDirection = 'en-vi';
                enViOption.classList.add('active');
                viEnOption.classList.remove('active');
            } else {
                currentDirection = 'vi-en';
                viEnOption.classList.add('active');
                enViOption.classList.remove('active');
            }
            updateLanguageLabels(currentDirection); 
            
            // Swap text content
            const tempText = inputText.value;
            inputText.value = outputText.value;
            outputText.value = tempText;
            
            // Update character count
            const event = new Event('input');
            inputText.dispatchEvent(event);
        });

        // Error handling (Từ V1)
        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
            setTimeout(() => {
                errorMessage.style.display = 'none';
            }, 5000);
        }

        // New API caller using Worker (Từ V1)
        async function sendMessage(msg) {
            try {
                const response = await fetch(workerUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: msg
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                return data?.choices?.[0]?.message?.content || JSON.stringify(data, null, 2);
            } catch (err) {
                console.error("Error:", err);
                throw new Error(`API call failed: ${err.message}`);
            }
        }

        // Translation function (Từ V1 - Logic giữ nguyên, tương thích UI mới)
        translateButton.addEventListener('click', async () => {
            const textToTranslate = inputText.value.trim();
            
            if (!textToTranslate) {
                showError('Please enter text you want to translate.');
                return;
            }

            if (textToTranslate.length > MAX_CHARS) {
                showError(`Text is too long. Please enter maximum ${MAX_CHARS} characters.`);
                return;
            }

            // Show loading state
            loadingSpinner.style.display = 'block';
            buttonText.style.display = 'none'; 
            translateIcon.style.display = 'none'; 
            translateButton.disabled = true;
            outputText.value = '';

            let prompt = "";
            // Prompts (Từ V1)
            if (currentDirection === "vi-en") {
                prompt = `dịch văn bản này sang tiếng anh như người mỹ viết, dựa theo ngữ cảnh và phong cách ngôn ngữ nói chuyện thông thường và chỉ cần phản hồi kết quả: ${textToTranslate}`;
            } else {
                prompt = `dịch văn bản này sang ngôn ngữ đang trò chuyện, với kiểu dịch dự theo ngữ cảnh và cách nói chuyện hằng ngày. Chỉ cần phản hồi kết quả: ${textToTranslate}`;
            }

            try {
                let translatedText = await sendMessage(prompt);

                // Remove content inside <think></think> tags (Từ V1)
                translatedText = (translatedText || '').replace(/<think>.*?<\/think>/gs, '');

                // Extract content inside quotes (Từ V1)
                const quoteMatch = translatedText.match(/"([^"]*)"/);
                if (quoteMatch) {
                    translatedText = quoteMatch[1];
                }

                // Clean up any extra whitespace that might be left (Từ V1)
                translatedText = translatedText.replace(/\n\s*\n/g, '\n').trim();

                if (!translatedText) {
                    showError('Unable to get translation result. Please try again.');
                }

                outputText.value = translatedText;

            } catch (error) {
                console.error('Error calling translation API:', error);
                showError(`An error occurred: ${error.message}. Please try again.`);
            } finally {
                // Reset loading state
                loadingSpinner.style.display = 'none';
                buttonText.style.display = 'block'; 
                translateIcon.style.display = 'block'; 
                // buttonText.textContent = 'Translate'; // Giữ nguyên text 'Translate'
                translateButton.disabled = false;
            }
        });

        // Enter key to translate (Từ V1)
        inputText.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && e.ctrlKey) {
                translateButton.click();
            }
        });

        // Mobile optimizations (Từ V1 - Giữ nguyên và vá lỗi V3)
        function isMobile() {
            return window.innerWidth <= 768;
        }

        // Prevent zoom on double tap for mobile (Từ V1)
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // Better touch handling for buttons (Từ V1)
        if (isMobile()) {
            // Add touch feedback for buttons
            const touchButtons = [translateButton, swapButton, viEnOption, enViOption, copyButton];
            touchButtons.forEach(button => {
                button.addEventListener('touchstart', function(e) {
                    // Ngăn sự kiện 'click' bị kích hoạt đồng thời
                    e.preventDefault(); 
                    this.style.transform = 'scale(0.98)';
                }, { passive: false });
                
                button.addEventListener('touchend', function() {
                    this.style.transform = '';
                    // Kích hoạt click theo cách thủ công khi nhả tay
                    this.click(); 
                });
                
                button.addEventListener('touchcancel', function() {
                    this.style.transform = '';
                });
            });

            // Auto-focus input on mobile for better UX (Từ V1)
            inputText.addEventListener('focus', function() {
                setTimeout(() => {
                    // Cuộn về đầu trang để thanh header hiện ra
                    window.scrollTo(0, 0); 
                }, 300);
            });

            // Prevent textarea zoom on iOS (Từ V1)
            inputText.addEventListener('focus', function() {
                if (isMobile()) {
                    this.style.fontSize = '16px';
                }
            });
        }
        
        // Hàm set --vh (Lấy từ V3/V1)
        function setVh() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        }

        // Optimize for mobile keyboard (Từ V1/V3)
        window.addEventListener('resize', setVh);
        window.addEventListener('orientationchange', setVh);
        
        // Gọi lần đầu khi tải trang
        setVh();
        
    </script>
</body>
</html>
